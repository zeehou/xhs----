# 小红书定时精准评论脚本

这是一个为 [Tampermonkey](https://www.tampermonkey.net/) (油猴) 设计的用户脚本，它允许用户在小红书的“发现”页面上，于预设的北京时间（默认为 00:30:00）自动发布一条指定内容的评论（默认为“p”）。

脚本内置了一个UI面板，可以实时显示当前的北京时间和距离目标时间的倒计时，以确保用户能够清晰地了解脚本的运行状态。

## ✨ 功能特性

- **精准定时**：使用网络时间源进行校准，确保倒计时的精准性，不受用户本地计算机时间的影响。
- **自动评论**：在到达预设时间点时，自动在评论框输入指定内容并点击发送按钮。
- **实时UI**：在页面右下角提供一个简洁的UI面板，显示：
    -   实时北京时间
    -   距离目标时间的倒计时
    -   脚本当前的运行状态（如：正在发送、已发送、同步失败等）。
- **健壮的错误处理**：
    -   内置网络请求重试机制，能有效应对暂时的网络波动。
    -   兼容多种API返回的时间格式。
    -   当找不到评论框或发送按钮时，会给出明确的提示。
- **高度可配置**：用户只需修改脚本头部的两个变量，即可轻松适配不同版本的小红书页面。

## 🚀 安装步骤

1.  **安装脚本管理器**：您需要在您的浏览器上安装一个用户脚本管理器。推荐使用 [Tampermonkey](https://www.tampermonkey.net/)，它支持 Chrome, Microsoft Edge, Safari, Opera Next, 和 Firefox 等主流浏览器。
2.  **安装本脚本**：
    *   点击 Tampermonkey 的扩展图标，选择“添加新脚本...”。
    *   将 `xiaohongshu_timed_comment.user.js` 文件的全部代码复制并粘贴到打开的编辑器中。
    *   点击编辑器上方的“文件”菜单，然后选择“保存”。

## 🛠️ 如何配置

在大多数情况下，您唯一需要修改的就是脚本顶部的CSS选择器，以确保脚本能够准确地找到页面上的“评论输入框”和“发送按钮”。

打开 `xiaohongshu_timed_comment.user.js` 文件，找到以下代码块：

```javascript
// ---! 重要：请将您找到的选择器粘贴到这里 !---
const COMMENT_INPUT_SELECTOR = '#content-textarea';
const SEND_BUTTON_SELECTOR = '.submit';
// ---! 修改结束 !---
```

### 如何找到正确的选择器？

1.  在小红书的帖子页面，将鼠标光标移动到**评论输入框**上。
2.  右键点击，选择“检查”或“审查元素”，浏览器会打开开发者工具并高亮显示该元素对应的HTML代码。
3.  在HTML代码上右键点击，选择“复制” -> “复制选择器”（Copy -> Copy selector）。
4.  将复制的字符串粘贴到 `COMMENT_INPUT_SELECTOR` 的引号内。
5.  对**发送按钮**重复以上步骤，并将结果粘贴到 `SEND_BUTTON_SELECTOR` 的引号内。

**示例**：如果您复制到的评论框选择器是 `#note-comment-input`，发送按钮是 `.comment-submit-btn`，那么您的配置应该如下：

```javascript
const COMMENT_INPUT_SELECTOR = '#note-comment-input';
const SEND_BUTTON_SELECTOR = '.comment-submit-btn';
```

> **注意**：如果小红书网站更新了其页面结构，您可能需要重新执行此步骤来更新选择器。

## 💡 使用方法

1.  安装并配置好脚本后，打开任意一个符合脚本 `@match` 规则的小红书页面（即 `https://www.xiaohongshu.com/explore/*`）。
2.  脚本将自动运行，您会在页面右下角看到一个黑色的半透明面板。
3.  面板会首先尝试同步网络时间，然后开始显示北京时间和倒计时。
4.  您只需保持该页面打开，当倒计时归零时，脚本便会自动执行评论操作。

## ❓ 常见问题排查

- **UI面板显示“状态: 时间同步失败”**
    -   **原因**: 脚本无法连接到用于获取标准北京时间的时间服务器。
    -   **解决方法**:
        1.  请检查您的网络连接是否正常。
        2.  可能是时间服务器暂时无法访问，请稍后刷新页面重试。脚本内置了重试机制，通常可以自行恢复。
        3.  确保您使用的代理或网络防火墙没有阻止脚本访问 `quan.suning.com`。

- **UI面板显示“状态: 评论框错误”或“状态: 发送钮错误”**
    -   **原因**: 脚本未能在页面上找到您配置的评论输入框或发送按钮。
    -   **解决方法**: 这几乎总是因为CSS选择器不正确或已过期。请严格按照上文 **[如何配置](#-如何配置)** 部分的指示，重新获取并更新您的选择器。

- **倒计时结束后没有任何反应**
    -   **原因**: 可能是因为发送按钮被禁用了（例如，没有输入内容时按钮是灰色的）。
    -   **解决方法**: 脚本会自动输入内容来尝试启用按钮，但如果网站逻辑复杂，可能无法成功。请确保您配置了正确的选择器，并且在倒计时结束前，发送按钮是可点击的状态。

---

*该脚本由 Gemini AI 创建和维护。*
